# =============================================================================
# AC FIXBOT - Variables de Entorno
# Copia este archivo a .env.local para desarrollo local
# =============================================================================

# =============================================================================
# REQUERIDAS - La aplicacion no iniciara sin estas variables
# =============================================================================

# Azure SQL Database - Connection string completo
SQL_CONNECTION_STRING=Server=tcp:sql-acfixbot.database.windows.net,1433;Database=db-acfixbot;User ID=admin;Password=YOUR_PASSWORD;Encrypt=true;TrustServerCertificate=false;Connection Timeout=30;

# WhatsApp Business API - Meta Graph API
WHATSAPP_TOKEN=your_whatsapp_access_token
WHATSAPP_PHONE_ID=123456789012345
WHATSAPP_VERIFY_TOKEN=your_verify_token

# =============================================================================
# OPCIONALES - Tienen valores por defecto pero se recomienda configurar
# =============================================================================

# --- Inteligencia Artificial ---
# Habilitar/Deshabilitar IA para deteccion de intenciones
USE_AI=true

# Proveedor de IA: 'gemini' (desarrollo) o 'azure-openai' (produccion)
AI_PROVIDER=gemini

# Google Gemini (desarrollo)
GEMINI_API_KEY=your_gemini_api_key

# Azure OpenAI (Produccion)
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_KEY=your_azure_openai_key
AZURE_OPENAI_DEPLOYMENT=gpt-4o-mini

# --- Transcripcion de Audio ---
# Habilitar transcripcion de mensajes de voz a texto con Azure
AUDIO_TRANSCRIPTION_ENABLED=false
# Nombre del deployment de audio en Azure OpenAI
AZURE_AUDIO_DEPLOYMENT=whisper

# --- Fallback Azure para Transcripcion ---
# Si Azure Whisper no esta disponible o excede limites, se usa Azure Speech

# Azure Speech Services: 5 HORAS gratis por mes (FALLBACK PRODUCCION)
# Crear recurso: https://portal.azure.com/#create/Microsoft.CognitiveServicesSpeechServices
# Usar tier F0 (gratuito)
AZURE_SPEECH_KEY=
AZURE_SPEECH_REGION=eastus

# --- SOLO DESARROLLO (NO usar en produccion Arca Continental) ---
# Google Speech-to-Text: 60 minutos gratis por mes
# Solo se activa si NODE_ENV != production
GOOGLE_SPEECH_API_KEY=

# --- Azure Computer Vision (OCR) ---
VISION_ENDPOINT=https://your-vision.cognitiveservices.azure.com/
VISION_KEY=your_vision_key

# --- Azure Blob Storage (Imagenes) ---
BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=stacfixbot;AccountKey=YOUR_KEY;EndpointSuffix=core.windows.net

# --- Configuracion de Sesiones ---
# Minutos de inactividad antes de cerrar sesion (default: 30)
SESSION_TIMEOUT_MINUTES=30
# Minutos de inactividad antes de enviar "Sigues ahi?" (default: 25)
SESSION_WARNING_MINUTES=25
# Schedule del timer de limpieza en formato CRON (default: cada 5 minutos)
TIMER_SCHEDULE=0 */5 * * * *

# --- Configuracion de Encuestas ---
# Schedule del timer de encuestas en formato CRON (default: 9:00 AM diario)
SURVEY_TIMER_SCHEDULE=0 0 9 * * *
# Horas a esperar despues de resolucion antes de enviar encuesta (default: 24)
SURVEY_HORAS_ESPERA=24
# Horas para expirar encuestas sin respuesta (default: 72)
SURVEY_HORAS_EXPIRACION=72

# --- Seguridad ---
# App Secret de WhatsApp para verificar firma X-Hub-Signature-256
WHATSAPP_APP_SECRET=your_app_secret
# Rate limiting por IP para APIs admin (default: 60 requests por minuto)
# La autenticaciÃ³n usa Azure Function Keys (ver Azure Portal > Function App > App Keys)
ADMIN_RATE_LIMIT_MAX=60

# --- Ambiente ---
# Ambiente de ejecucion: development, test, production
NODE_ENV=development

# --- Alertas y Monitoreo ---
# URL de webhook para recibir alertas en Slack o Microsoft Teams
# Slack: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX
# Teams: https://outlook.office.com/webhook/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
ALERT_WEBHOOK_URL=

# =============================================================================
# FASE 3 - ESCALABILIDAD (OPCIONAL)
# Habilitar solo cuando se necesite escalar a multiples instancias
# =============================================================================

# --- Azure Cache for Redis ---
# Cache distribuido para sesiones y datos de equipos
# Reemplaza cache local (Map) cuando hay multiples instancias de Azure Functions
REDIS_ENABLED=false
REDIS_HOST=your-redis.redis.cache.windows.net
REDIS_PORT=6380
REDIS_PASSWORD=your_redis_access_key
REDIS_TLS=true
REDIS_KEY_PREFIX=acfixbot:

# --- Azure Service Bus ---
# Dead Letter Queue distribuida para manejo de mensajes fallidos
# Reemplaza tabla SQL cuando se necesita procesamiento event-driven
SERVICEBUS_ENABLED=false
SERVICEBUS_CONNECTION_STRING=Endpoint=sb://your-namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=YOUR_KEY
SERVICEBUS_QUEUE_NAME=acfixbot-messages
SERVICEBUS_DLQ_NAME=acfixbot-dlq
