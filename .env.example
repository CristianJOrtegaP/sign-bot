# =============================================================================
# SIGN BOT - Variables de Entorno
# Copia este archivo a .env.local para desarrollo local
# =============================================================================

# =============================================================================
# REQUERIDAS - La aplicacion no iniciara sin estas variables
# =============================================================================

# Azure SQL Database - Connection string completo
SQL_CONNECTION_STRING=Server=tcp:sql-signbot.database.windows.net,1433;Database=db-signbot;User ID=admin;Password=YOUR_PASSWORD;Encrypt=true;TrustServerCertificate=false;Connection Timeout=30;

# WhatsApp Business API - Meta Graph API
WHATSAPP_TOKEN=your_whatsapp_access_token
WHATSAPP_PHONE_ID=123456789012345
WHATSAPP_VERIFY_TOKEN=your_verify_token

# =============================================================================
# OPCIONALES - Tienen valores por defecto pero se recomienda configurar
# =============================================================================

# --- DocuSign eSign API ---
# Tipo de autenticacion: JWT Grant (server-to-server)
DOCUSIGN_INTEGRATION_KEY=your_integration_key
DOCUSIGN_USER_ID=your_user_id_guid
DOCUSIGN_ACCOUNT_ID=your_account_id
# Base URL: https://demo.docusign.net/restapi para sandbox, https://na3.docusign.net/restapi para produccion
DOCUSIGN_BASE_URL=https://demo.docusign.net/restapi
# RSA Private Key (PEM format, newlines reemplazados con \n)
DOCUSIGN_RSA_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----\nYOUR_KEY_HERE\n-----END RSA PRIVATE KEY-----
# HMAC Secret para validar webhooks de DocuSign Connect
DOCUSIGN_WEBHOOK_SECRET=your_hmac_secret
# Dias de expiracion del envelope en DocuSign (default: 365)
DOCUSIGN_ENVELOPE_EXPIRATION_DAYS=365

# --- Configuracion de Firma ---
# Horas entre recordatorios al cliente (default: 48)
FIRMA_REMINDER_HOURS_CLIENTE=48
# Maximo de recordatorios al cliente antes de dejar de recordar (default: 5)
FIRMA_MAX_RECORDATORIOS_CLIENTE=5
# Dias entre reportes al remitente SAP/Teams (default: 7)
FIRMA_REMINDER_DAYS_SAP=7
# Dias de inactividad para housekeeping - void del envelope (default: 30)
FIRMA_HOUSEKEEPING_DAYS=30
# Schedule del timer de recordatorios en formato CRON (default: cada hora)
FIRMA_TIMER_SCHEDULE=0 0 * * * *

# --- Azure Blob Storage (Documentos PDF) ---
BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=stsignbot;AccountKey=YOUR_KEY;EndpointSuffix=core.windows.net
# Horas de expiracion del SAS token para PDFs (default: 72h)
BLOB_SAS_EXPIRY_HOURS=72

# --- Pool de Conexiones SQL (Tuning avanzado) ---
SQL_POOL_MIN=0
SQL_POOL_MAX=10
SQL_POOL_IDLE_TIMEOUT_MS=120000
SQL_POOL_ACQUIRE_TIMEOUT_MS=15000

# --- Configuracion de Sesiones ---
SESSION_TIMEOUT_MINUTES=30
SESSION_WARNING_MINUTES=25
TIMER_SCHEDULE=0 */5 * * * *

# --- Seguridad ---
# App Secret de WhatsApp para verificar firma X-Hub-Signature-256
WHATSAPP_APP_SECRET=your_app_secret
# Rate limiting por IP para APIs admin (default: 60 requests por minuto)
# La autenticacion usa Azure Function Keys (ver Azure Portal > Function App > App Keys)
ADMIN_RATE_LIMIT_MAX=60
# Fallback API key para admin (cuando authLevel es anonymous, ej. SWA Free tier)
# Si se configura, se valida via header x-api-key o query param ?code=
# ADMIN_API_KEY=your_admin_api_key

# --- Ambiente ---
NODE_ENV=development

# --- Alertas y Monitoreo ---
# URL de webhook de Microsoft Teams (Incoming Webhook al canal)
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# =============================================================================
# ESCALABILIDAD (OPCIONAL)
# Habilitar solo cuando se necesite escalar a multiples instancias
# =============================================================================

# --- Azure Cache for Redis ---
REDIS_ENABLED=false
REDIS_HOST=your-redis.redis.cache.windows.net
REDIS_PORT=6380
REDIS_PASSWORD=your_redis_access_key
REDIS_TLS=true
REDIS_KEY_PREFIX=signbot:

# --- Azure Service Bus ---
SERVICEBUS_ENABLED=false
SERVICEBUS_CONNECTION_STRING=Endpoint=sb://your-namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=YOUR_KEY
SERVICEBUS_QUEUE_NAME=signbot-messages
SERVICEBUS_DLQ_NAME=signbot-dlq
